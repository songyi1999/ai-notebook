# AIç¬”è®°æœ¬é¡¹ç›®

## é¡¹ç›®æ¦‚è¿°

ä¸€ä¸ª**çº¯æœ¬åœ°è¿è¡Œã€AIå¢å¼º**çš„ä¸ªäººçŸ¥è¯†ç®¡ç†ç³»ç»Ÿï¼Œä¸“æ³¨äºéšç§ä¿æŠ¤å’Œæ•°æ®å®‰å…¨ã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ”’ **çº¯æœ¬åœ°è¿è¡Œ**ï¼šæ‰€æœ‰æ•°æ®ä¿å­˜åœ¨æœ¬åœ°ï¼Œç¡®ä¿éšç§å®‰å…¨
- ğŸ“ **Markdownç¼–è¾‘**ï¼šæ”¯æŒå®æ—¶é¢„è§ˆçš„ä¸“ä¸šMarkdownç¼–è¾‘å™¨
- ğŸ”— **æ™ºèƒ½é“¾æ¥**ï¼šåŒå‘é“¾æ¥ + AIæ™ºèƒ½å‘ç° + æ‰‹åŠ¨ç®¡ç†
- ğŸ” **æ··åˆæœç´¢**ï¼šå…³é”®è¯æœç´¢ + è¯­ä¹‰æœç´¢ï¼Œç²¾å‡†å®šä½å†…å®¹
- ğŸ¤– **AIé—®ç­”**ï¼šåŸºäºç¬”è®°å†…å®¹çš„æ™ºèƒ½RAGé—®ç­”ç³»ç»Ÿ
- ğŸ·ï¸ **æ™ºèƒ½æ ‡ç­¾**ï¼šAIè‡ªåŠ¨æå– + æ‰‹åŠ¨ç®¡ç†æ ‡ç­¾ç³»ç»Ÿ
- ğŸ“Š **å…³ç³»å›¾è°±**ï¼šå¯è§†åŒ–ç¬”è®°é—´çš„é“¾æ¥å…³ç³»ç½‘ç»œ
- ğŸ› ï¸ **MCPæ”¯æŒ**ï¼šé›†æˆModel Context Protocolå·¥å…·ç”Ÿæ€
- ğŸ³ **å®¹å™¨åŒ–**ï¼šDockerä¸€é”®éƒ¨ç½²ï¼Œè·¨å¹³å°å…¼å®¹

## åŠŸèƒ½æ¨¡å—è¯¦è§£

### ğŸ“ ç¬”è®°ç¼–è¾‘å™¨
- **Monaco Editor**ï¼šVS CodeåŒæ¬¾ç¼–è¾‘å™¨å†…æ ¸
- **å®æ—¶é¢„è§ˆ**ï¼šMarkdownå®æ—¶æ¸²æŸ“é¢„è§ˆ
- **è¯­æ³•é«˜äº®**ï¼šæ”¯æŒä»£ç å—è¯­æ³•é«˜äº®
- **è‡ªåŠ¨ä¿å­˜**ï¼šæ™ºèƒ½æ£€æµ‹ä¿®æ”¹å¹¶è‡ªåŠ¨ä¿å­˜

### ğŸ”— é“¾æ¥ç®¡ç†ç³»ç»Ÿï¼ˆå·²ä¿®å¤ï¼‰
- **åŒå‘é“¾æ¥**ï¼šä½¿ç”¨ `[[æ–‡ä»¶å]]` è¯­æ³•åˆ›å»ºåŒå‘é“¾æ¥
- **AIæ™ºèƒ½å‘ç°**ï¼šè‡ªåŠ¨åˆ†ææ–‡æ¡£å…³ç³»ï¼Œå»ºè®®ç›¸å…³é“¾æ¥
- **æ‰‹åŠ¨åˆ›å»º**ï¼šé€šè¿‡"é“¾æ¥ç®¡ç†"æ ‡ç­¾é¡µæ‰‹åŠ¨åˆ›å»ºä»»æ„æ–‡ä»¶é—´çš„é“¾æ¥
- **é“¾æ¥ç±»å‹**ï¼šæ”¯æŒreferenceã€relatedã€follow_upã€prerequisiteã€exampleã€contradictionç­‰ç±»å‹
- **å¯è§†åŒ–å±•ç¤º**ï¼šåœ¨å…³ç³»å›¾è°±ä¸­ç›´è§‚æŸ¥çœ‹é“¾æ¥ç½‘ç»œ

#### æœ€æ–°ä¿®å¤ï¼ˆ2025-01-04ï¼‰
- âœ… **å›¾è°±æ˜¾ç¤ºä¿®å¤**ï¼šè§£å†³äº†å›¾è°±æ ‡ç­¾é¡µæ˜¾ç¤ºä¸ºç©ºçš„é—®é¢˜
- âœ… **æ•°æ®æµä¿®å¤**ï¼šä¿®æ­£äº†æ–‡ä»¶å’Œé“¾æ¥æ•°æ®çš„åŠ è½½ä¸æ¸²æŸ“æ—¶åº
- âœ… **ç»Ÿè®¡æ˜¾ç¤ºæ­£å¸¸**ï¼šå›¾è°±ç»Ÿè®¡ä¿¡æ¯ï¼ˆèŠ‚ç‚¹æ•°ã€è¿æ¥æ•°ç­‰ï¼‰æ­£ç¡®æ˜¾ç¤º
- âœ… **æ•°æ®åº“ç»“æ„ä¿®å¤**ï¼šä¿®å¤äº†linksè¡¨ç¼ºå¤±anchor_textåˆ—çš„é—®é¢˜
- âœ… **APIé”™è¯¯ä¿®å¤**ï¼šè§£å†³äº†GET /api/v1/linksæ¥å£500é”™è¯¯
- âœ… **æ•°æ®åº“å…¼å®¹æ€§**ï¼šä½¿ç”¨ALTER TABLEè‡ªåŠ¨æ·»åŠ ç¼ºå¤±åˆ—ï¼Œä¿æŒæ•°æ®å®Œæ•´æ€§
- âœ… ä¿®å¤äº†é“¾æ¥åˆ›å»ºAPIçš„422é”™è¯¯ï¼ˆlink_textå­—æ®µé—®é¢˜ï¼‰
- âœ… æ·»åŠ äº†"é“¾æ¥ç®¡ç†"æ ‡ç­¾é¡µåˆ°ä¸»ç•Œé¢
- âœ… ä¼˜åŒ–äº†é“¾æ¥æ•°æ®æ¨¡å‹ï¼Œæ”¯æŒå¯é€‰çš„link_textå’Œanchor_textå­—æ®µ
- âœ… å®ç°äº†æ™ºèƒ½é»˜è®¤å€¼ç”Ÿæˆï¼šè‡ªåŠ¨ä½¿ç”¨ç›®æ ‡æ–‡ä»¶åä½œä¸ºé“¾æ¥æ–‡æœ¬
- âœ… å®Œå–„äº†ç»„ä»¶é›†æˆæ£€æŸ¥ï¼Œç¡®ä¿æ‰€æœ‰åŠŸèƒ½ç»„ä»¶éƒ½æ­£ç¡®é›†æˆåˆ°ä¸»ç•Œé¢
- âœ… **ä»£ç é‡æ„**ï¼šæ¸…ç†äº†ai_service_langchain.pyä¸­çš„é‡å¤ä»£ç å®ç°ï¼Œä»2243è¡Œä¼˜åŒ–åˆ°1825è¡Œï¼Œæå‡ä»£ç å¯ç»´æŠ¤æ€§

### ğŸ” æ™ºèƒ½æœç´¢
- **å…³é”®è¯æœç´¢**ï¼šåŸºäºSQLite FTS5å…¨æ–‡æœç´¢
- **è¯­ä¹‰æœç´¢**ï¼šåŸºäºå‘é‡ç›¸ä¼¼åº¦çš„è¯­ä¹‰ç†è§£
- **æ··åˆæœç´¢**ï¼šç»“åˆå…³é”®è¯å’Œè¯­ä¹‰çš„æœ€ä½³æœç´¢ä½“éªŒ
- **æœç´¢å†å²**ï¼šè®°å½•å’Œç®¡ç†æœç´¢å†å²

### ğŸ¤– AIåŠŸèƒ½é›†æˆ
- **RAGé—®ç­”**ï¼šåŸºäºç¬”è®°å†…å®¹çš„æ™ºèƒ½é—®ç­”
- **æ ‡ç­¾ç”Ÿæˆ**ï¼šAIåˆ†æå†…å®¹è‡ªåŠ¨ç”Ÿæˆç›¸å…³æ ‡ç­¾
- **é“¾æ¥å‘ç°**ï¼šAIæ™ºèƒ½åˆ†ææ–‡æ¡£å…³ç³»ï¼Œå»ºè®®æ½œåœ¨é“¾æ¥
- **å†…å®¹åˆ†æ**ï¼šæ·±åº¦ç†è§£æ–‡æ¡£å†…å®¹å’Œç»“æ„

### ğŸ·ï¸ æ ‡ç­¾ç³»ç»Ÿ
- **AIæ™ºèƒ½å»ºè®®**ï¼šåŸºäºå†…å®¹è‡ªåŠ¨å»ºè®®æ ‡ç­¾
- **æ‰‹åŠ¨ç®¡ç†**ï¼šåˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤æ ‡ç­¾
- **æ ‡ç­¾ç»Ÿè®¡**ï¼šæ˜¾ç¤ºæ ‡ç­¾ä½¿ç”¨é¢‘ç‡å’Œå…³è”æ–‡ä»¶
- **é¢œè‰²åˆ†ç±»**ï¼šæ”¯æŒè‡ªå®šä¹‰æ ‡ç­¾é¢œè‰²

### ğŸ“Š å…³ç³»å›¾è°±
- **é“¾æ¥å¯è§†åŒ–**ï¼šD3.jsé©±åŠ¨çš„äº¤äº’å¼å…³ç³»å›¾
- **èŠ‚ç‚¹äº¤äº’**ï¼šç‚¹å‡»èŠ‚ç‚¹è·³è½¬åˆ°å¯¹åº”æ–‡ä»¶
- **å¸ƒå±€ç®—æ³•**ï¼šæ™ºèƒ½å¸ƒå±€ç®—æ³•ä¼˜åŒ–å›¾è°±å±•ç¤º
- **è¿‡æ»¤åŠŸèƒ½**ï¼šæŒ‰ç±»å‹ã€æ—¶é—´ç­‰æ¡ä»¶è¿‡æ»¤æ˜¾ç¤º

### ğŸ“ˆ ç³»ç»Ÿç›‘æ§ä¸æ§åˆ¶ï¼ˆv1.3.3æ–°å¢ï¼‰
- **çŠ¶æ€ç›‘æ§**ï¼šå®æ—¶æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€ï¼ˆæ–‡ä»¶æ•°ã€åµŒå…¥æ•°ã€å¾…ç´¢å¼•ä»»åŠ¡æ•°ï¼‰
- **å¤„ç†å™¨çŠ¶æ€**ï¼šæ˜¾ç¤ºä»»åŠ¡å¤„ç†å™¨è¿è¡ŒçŠ¶æ€ï¼Œæ”¯æŒPIDæ£€æµ‹
- **æ‰‹åŠ¨æ§åˆ¶**ï¼šæ”¯æŒæ‰‹åŠ¨å¯åŠ¨/åœæ­¢ä»»åŠ¡å¤„ç†å™¨
- **æ™ºèƒ½æé†’**ï¼šå½“æœ‰å¾…ç´¢å¼•ä»»åŠ¡ä¸”å¤„ç†å™¨åœæ­¢æ—¶ï¼Œæ˜¾ç¤ºé†’ç›®çš„"å¼€å§‹ç´¢å¼•"æŒ‰é’®
- **çŠ¶æ€æŒ‡ç¤ºå™¨**ï¼šç»¿è‰²â—è¡¨ç¤ºè¿è¡Œä¸­ï¼Œçº¢è‰²â—‹è¡¨ç¤ºå·²åœæ­¢
- **è‡ªåŠ¨åˆ·æ–°**ï¼šæ¯60ç§’è‡ªåŠ¨åˆ·æ–°ç³»ç»ŸçŠ¶æ€

### ğŸ› ï¸ MCPå·¥å…·é›†æˆ
- **åè®®æ”¯æŒ**ï¼šå®Œæ•´çš„Model Context Protocolæ”¯æŒ
- **æœåŠ¡å™¨ç®¡ç†**ï¼šç®¡ç†å’Œé…ç½®MCPæœåŠ¡å™¨
- **å·¥å…·å‘ç°**ï¼šè‡ªåŠ¨å‘ç°å’Œæ³¨å†ŒMCPå·¥å…·
- **è°ƒç”¨å†å²**ï¼šè®°å½•å’Œç®¡ç†å·¥å…·è°ƒç”¨å†å²

## æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
- **React 18** + **TypeScript**ï¼šç°ä»£åŒ–å‰ç«¯æ¡†æ¶
- **Ant Design**ï¼šä¼ä¸šçº§UIç»„ä»¶åº“
- **Monaco Editor**ï¼šVS Codeç¼–è¾‘å™¨å†…æ ¸
- **D3.js**ï¼šæ•°æ®å¯è§†åŒ–å›¾è¡¨åº“
- **Zustand**ï¼šè½»é‡çº§çŠ¶æ€ç®¡ç†
- **Vite**ï¼šå¿«é€Ÿæ„å»ºå·¥å…·

### åç«¯æŠ€æœ¯æ ˆ
- **FastAPI**ï¼šé«˜æ€§èƒ½Python Webæ¡†æ¶
- **SQLite**ï¼šè½»é‡çº§å…³ç³»æ•°æ®åº“
- **ChromaDB**ï¼šå‘é‡æ•°æ®åº“ï¼Œæ”¯æŒè¯­ä¹‰æœç´¢
- **Pydantic**ï¼šæ•°æ®éªŒè¯å’Œåºåˆ—åŒ–
- **SQLAlchemy**ï¼šORMæ•°æ®åº“æ“ä½œ

### AIé›†æˆ
- **OpenAIå…¼å®¹æ¥å£**ï¼šæ”¯æŒæœ¬åœ°LLMæœåŠ¡
- **æ ‡å‡†åµŒå…¥æ¥å£**ï¼š`/v1/embeddings` æ ‡å‡†æ¥å£
- **RAGæ¶æ„**ï¼šæ£€ç´¢å¢å¼ºç”Ÿæˆé—®ç­”ç³»ç»Ÿ
- **å‘é‡æœç´¢**ï¼šChromaDBè¯­ä¹‰ç›¸ä¼¼åº¦æœç´¢

## æ•°æ®åº“ç»“æ„

### æ ¸å¿ƒè¡¨ç»“æ„
- **files**ï¼šæ–‡ä»¶åŸºæœ¬ä¿¡æ¯å’Œå†…å®¹
- **tags**ï¼šæ ‡ç­¾å®šä¹‰å’Œå±æ€§
- **file_tags**ï¼šæ–‡ä»¶æ ‡ç­¾å…³è”å…³ç³»
- **links**ï¼šæ–‡ä»¶é—´é“¾æ¥å…³ç³»ï¼ˆå·²ä¼˜åŒ–ï¼‰
- **search_history**ï¼šæœç´¢å†å²è®°å½•
- **pending_tasks**ï¼šåå°ä»»åŠ¡é˜Ÿåˆ—
- **mcp_servers**ï¼šMCPæœåŠ¡å™¨é…ç½®
- **mcp_tools**ï¼šMCPå·¥å…·æ³¨å†Œä¿¡æ¯
- **mcp_tool_calls**ï¼šMCPå·¥å…·è°ƒç”¨å†å²

### é“¾æ¥è¡¨ç»“æ„ï¼ˆæœ€æ–°ä¼˜åŒ–ï¼‰
```sql
CREATE TABLE links (
    id INTEGER PRIMARY KEY,
    source_file_id INTEGER NOT NULL,
    target_file_id INTEGER,
    link_text TEXT,                 -- å¯é€‰å­—æ®µï¼Œè‡ªåŠ¨ç”Ÿæˆé»˜è®¤å€¼
    link_type VARCHAR DEFAULT 'wikilink',
    anchor_text TEXT,               -- æ–°å¢é”šç‚¹æ–‡æœ¬å­—æ®µ
    position_start INTEGER,
    position_end INTEGER,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    is_valid BOOLEAN DEFAULT TRUE
);
```

## å®‰è£…å’Œéƒ¨ç½²

### ç¯å¢ƒè¦æ±‚
- Docker & Docker Compose
- æœ¬åœ°LLMæœåŠ¡ï¼ˆå¯é€‰ï¼Œæ¨èOllamaï¼‰

### å¿«é€Ÿå¯åŠ¨
```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd AIç¬”è®°æœ¬é¡¹ç›®

# é…ç½®ç¯å¢ƒå˜é‡
cp env.example .env
# ç¼–è¾‘.envæ–‡ä»¶ï¼Œé…ç½®AIæœåŠ¡åœ°å€

# å¯åŠ¨æœåŠ¡
docker-compose up -d --build

# è®¿é—®åº”ç”¨
http://localhost:3000
```

### æœ¬åœ°LLMé…ç½®
```bash
# å®‰è£…Ollamaï¼ˆæ¨èï¼‰
curl -fsSL https://ollama.ai/install.sh | sh

# ä¸‹è½½æ¨¡å‹
ollama pull qwen2.5:7b
ollama pull nomic-embed-text

# é…ç½®.env
OPENAI_BASE_URL=http://host.docker.internal:11434/v1
OPENAI_API_KEY=ollama
EMBEDDING_BASE_URL=http://host.docker.internal:11434/v1
EMBEDDING_API_KEY=ollama
EMBEDDING_MODEL=nomic-embed-text
```

## ä½¿ç”¨æŒ‡å—

### åŸºç¡€æ“ä½œ
1. **åˆ›å»ºç¬”è®°**ï¼šåœ¨æ–‡ä»¶æ ‘ä¸­å³é”®åˆ›å»ºæ–°æ–‡ä»¶
2. **ç¼–è¾‘å†…å®¹**ï¼šä½¿ç”¨Markdownè¯­æ³•ç¼–å†™å†…å®¹
3. **ä¿å­˜æ–‡ä»¶**ï¼šCtrl+Sæˆ–ç‚¹å‡»ä¿å­˜æŒ‰é’®
4. **æœç´¢å†…å®¹**ï¼šCtrl+Kæ‰“å¼€æœç´¢æ¡†
5. **AIé—®ç­”**ï¼šCtrl+/æ‰“å¼€AIåŠ©æ‰‹

### é“¾æ¥ç®¡ç†
1. **åŒå‘é“¾æ¥**ï¼šåœ¨ç¼–è¾‘å™¨ä¸­ä½¿ç”¨ `[[æ–‡ä»¶å]]` è¯­æ³•
2. **æ‰‹åŠ¨åˆ›å»º**ï¼šåœ¨"é“¾æ¥ç®¡ç†"æ ‡ç­¾é¡µç‚¹å‡»"æ–°å»ºé“¾æ¥"
3. **AIå‘ç°**ï¼šåœ¨"AIå¤„ç†"æ ‡ç­¾é¡µå¼€å¯"è‡ªåŠ¨å‘ç°å’Œåˆ›å»ºé“¾æ¥"
4. **æŸ¥çœ‹å…³ç³»**ï¼šåœ¨"å›¾è°±"æ ‡ç­¾é¡µæŸ¥çœ‹é“¾æ¥å…³ç³»ç½‘ç»œ

### æ ‡ç­¾ç³»ç»Ÿ
1. **AIç”Ÿæˆ**ï¼šåœ¨"æ ‡ç­¾"æ ‡ç­¾é¡µç‚¹å‡»"AIå»ºè®®æ ‡ç­¾"
2. **æ‰‹åŠ¨æ·»åŠ **ï¼šç›´æ¥è¾“å…¥æ ‡ç­¾åç§°æ·»åŠ 
3. **æ‰¹é‡å¤„ç†**ï¼šåœ¨"AIå¤„ç†"æ ‡ç­¾é¡µæ‰¹é‡å¤„ç†å¤šä¸ªæ–‡ä»¶

## å‡½æ•°è°ƒç”¨æ ¼å¼è¡¨æ ¼

### ğŸ” ä½¿ç”¨çŠ¶æ€è¯´æ˜
- âœ… **ä½¿ç”¨ä¸­**ï¼šå·²è¢«å‰ç«¯ç»„ä»¶è°ƒç”¨çš„å‡½æ•°
- âš ï¸ **æœªä½¿ç”¨**ï¼šå·²å®ç°ä½†æœªè¢«è°ƒç”¨çš„å‡½æ•°
- âŒ **å»ºè®®åˆ é™¤**ï¼šå†—ä½™æˆ–æ— ç”¨çš„å‡½æ•°

### ğŸ“š åç«¯APIæ¥å£

#### æ–‡ä»¶ç®¡ç†API (files.py)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `create_file_api` | `file: FileCreate` | `FileResponse` | åˆ›å»ºæ–°æ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |
| `read_files_api` | `skip: int, limit: int, include_deleted: bool` | `List[FileResponse]` | è·å–æ–‡ä»¶åˆ—è¡¨ | âš ï¸ æœªä½¿ç”¨ |
| `read_file_by_path_api` | `file_path: str` | `FileResponse` | é€šè¿‡è·¯å¾„è·å–æ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |
| `get_file_tree_api` | `root_path: str` | `List[FileTreeNode]` | è·å–æ–‡ä»¶æ ‘ç»“æ„ | âœ… ä½¿ç”¨ä¸­ |
| `create_directory_api` | `request: dict` | `dict` | åˆ›å»ºç›®å½• | âœ… ä½¿ç”¨ä¸­ |
| `search_files_api` | `query: str, search_type: str, limit: int` | `SearchResponse` | æ–‡ä»¶æœç´¢ | âœ… ä½¿ç”¨ä¸­ |
| `get_search_history_api` | `limit: int` | `List[SearchHistory]` | è·å–æœç´¢å†å² | âœ… ä½¿ç”¨ä¸­ |
| `get_popular_queries_api` | `limit: int` | `List[PopularQuery]` | è·å–çƒ­é—¨æŸ¥è¯¢ | âœ… ä½¿ç”¨ä¸­ |
| `delete_file_by_path_api` | `request: dict` | `dict` | é€šè¿‡è·¯å¾„åˆ é™¤æ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |
| `move_file_api` | `request: dict` | `dict` | ç§»åŠ¨æ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |
| `read_file_api` | `file_id: int` | `FileResponse` | è·å–æ–‡ä»¶è¯¦æƒ… | âš ï¸ æœªä½¿ç”¨ |
| `update_file_api` | `file_id: int, file: FileUpdate` | `FileResponse` | æ›´æ–°æ–‡ä»¶å†…å®¹ | âœ… ä½¿ç”¨ä¸­ |
| `update_file_by_path_api` | `file_path: str, file: FileUpdate` | `FileResponse` | é€šè¿‡è·¯å¾„æ›´æ–°æ–‡ä»¶ | âš ï¸ æœªä½¿ç”¨ |
| `delete_file_api` | `file_id: int` | `dict` | åˆ é™¤æ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |

#### æ ‡ç­¾ç®¡ç†API (tags.py)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `create_tag_api` | `tag: TagCreate` | `TagResponse` | åˆ›å»ºæ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `read_tag_api` | `tag_id: int` | `TagResponse` | è·å–æ ‡ç­¾è¯¦æƒ… | âš ï¸ æœªä½¿ç”¨ |
| `read_all_tags_api` | `skip: int, limit: int` | `List[TagResponse]` | è·å–æ ‡ç­¾åˆ—è¡¨ | âœ… ä½¿ç”¨ä¸­ |
| `read_tags_with_stats_api` | `skip: int, limit: int` | `List[TagWithStats]` | è·å–å¸¦ç»Ÿè®¡çš„æ ‡ç­¾åˆ—è¡¨ | âœ… ä½¿ç”¨ä¸­ |
| `get_tag_usage_count_api` | `tag_id: int` | `dict` | è·å–æ ‡ç­¾ä½¿ç”¨æ¬¡æ•° | âš ï¸ æœªä½¿ç”¨ |
| `update_tag_api` | `tag_id: int, tag: TagUpdate` | `TagResponse` | æ›´æ–°æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `delete_tag_api` | `tag_id: int` | `None` | åˆ é™¤æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `create_file_tag_api` | `file_tag: FileTagCreate` | `FileTagResponse` | ä¸ºæ–‡ä»¶æ·»åŠ æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `get_file_tags_api` | `file_id: int` | `List[FileTagResponse]` | è·å–æ–‡ä»¶çš„æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `delete_file_tag_api` | `file_id: int, tag_id: int` | `None` | åˆ é™¤æ–‡ä»¶æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |

#### é“¾æ¥ç®¡ç†API (links.py)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `create_link_api` | `link: LinkCreate` | `LinkResponse` | åˆ›å»ºæ–°é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `read_link_api` | `link_id: int` | `LinkResponse` | è·å–é“¾æ¥è¯¦æƒ… | âš ï¸ æœªä½¿ç”¨ |
| `read_links_by_file_api` | `file_id: int` | `List[LinkResponse]` | è·å–æ–‡ä»¶çš„é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `read_all_links_api` | `skip: int, limit: int` | `List[LinkResponse]` | è·å–æ‰€æœ‰é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `update_link_api` | `link_id: int, link: LinkUpdate` | `LinkResponse` | æ›´æ–°é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `delete_link_api` | `link_id: int` | `None` | åˆ é™¤é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |

#### AIæœåŠ¡API (ai.py)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `generate_summary_api` | `request: SummaryRequest` | `dict` | å†…å®¹æ‘˜è¦ | âš ï¸ æœªä½¿ç”¨ |
| `suggest_tags_api` | `request: TagSuggestionRequest` | `List[str]` | AIæ ‡ç­¾å»ºè®® | âœ… ä½¿ç”¨ä¸­ |
| `create_embeddings_api` | `file_id: int` | `dict` | åˆ›å»ºåµŒå…¥ | âš ï¸ æœªä½¿ç”¨ |
| `semantic_search_api` | `request: SemanticSearchRequest` | `dict` | è¯­ä¹‰æœç´¢ | âš ï¸ æœªä½¿ç”¨ |
| `analyze_content_api` | `request: ContentAnalysisRequest` | `dict` | å†…å®¹åˆ†æ | âš ï¸ æœªä½¿ç”¨ |
| `generate_related_questions_api` | `request: RelatedQuestionsRequest` | `List[str]` | ç›¸å…³é—®é¢˜ | âš ï¸ æœªä½¿ç”¨ |
| `chat_api` | `request: ChatRequest` | `ChatResponse` | RAGæ™ºèƒ½é—®ç­” | âœ… ä½¿ç”¨ä¸­ |
| `discover_smart_links_api` | `file_id: int` | `List[SmartLinkSuggestion]` | AIé“¾æ¥å‘ç° | âœ… ä½¿ç”¨ä¸­ |
| `get_ai_status_api` | `None` | `dict` | AIæœåŠ¡çŠ¶æ€æ£€æŸ¥ | âœ… ä½¿ç”¨ä¸­ |

#### ç´¢å¼•ç®¡ç†API (index.py)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `get_index_status` | `None` | `dict` | ç´¢å¼•çŠ¶æ€ | âš ï¸ æœªä½¿ç”¨ |
| `rebuild_index` | `None` | `dict` | é‡å»ºç´¢å¼• | âœ… ä½¿ç”¨ä¸­ |
| `get_rebuild_progress` | `None` | `dict` | é‡å»ºè¿›åº¦ | âš ï¸ æœªä½¿ç”¨ |
| `scan_notes_directory` | `None` | `dict` | æ‰«ææ–‡ä»¶ | âš ï¸ æœªä½¿ç”¨ |
| `get_system_status` | `None` | `dict` | ç³»ç»ŸçŠ¶æ€ | âœ… ä½¿ç”¨ä¸­ |
| `get_processor_status` | `None` | `dict` | è·å–ä»»åŠ¡å¤„ç†å™¨çŠ¶æ€ï¼ˆv1.3.3æ–°å¢ï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `start_processor` | `force: bool` | `dict` | å¯åŠ¨ä»»åŠ¡å¤„ç†å™¨ï¼ˆv1.3.3æ–°å¢ï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `stop_processor` | `None` | `dict` | åœæ­¢ä»»åŠ¡å¤„ç†å™¨ï¼ˆv1.3.3æ–°å¢ï¼‰| âœ… ä½¿ç”¨ä¸­ |



#### MCPé›†æˆAPI (mcp.py)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `get_mcp_servers` | `None` | `List[MCPServerResponse]` | MCPæœåŠ¡å™¨åˆ—è¡¨ | âœ… ä½¿ç”¨ä¸­ |
| `get_mcp_server` | `server_id: int` | `MCPServerWithTools` | è·å–æœåŠ¡å™¨è¯¦æƒ… | âš ï¸ æœªä½¿ç”¨ |
| `delete_mcp_server` | `server_id: int` | `None` | åˆ é™¤æœåŠ¡å™¨ | âœ… ä½¿ç”¨ä¸­ |
| `get_mcp_server_status` | `server_id: int` | `MCPServerStatus` | æœåŠ¡å™¨çŠ¶æ€ | âš ï¸ æœªä½¿ç”¨ |
| `get_available_tools` | `None` | `List[MCPToolResponse]` | MCPå·¥å…·åˆ—è¡¨ | âœ… ä½¿ç”¨ä¸­ |
| `get_mcp_tool` | `tool_id: int` | `MCPToolResponse` | è·å–å·¥å…·è¯¦æƒ… | âš ï¸ æœªä½¿ç”¨ |
| `get_tool_calls` | `limit: int` | `List[MCPToolCallResponse]` | å·¥å…·è°ƒç”¨å†å² | âš ï¸ æœªä½¿ç”¨ |
| `get_tool_call` | `call_id: int` | `MCPToolCallResponse` | è·å–è°ƒç”¨è¯¦æƒ… | âš ï¸ æœªä½¿ç”¨ |
| `update_tool_call_feedback` | `call_id: int, feedback: dict` | `None` | è°ƒç”¨åé¦ˆ | âš ï¸ æœªä½¿ç”¨ |
| `get_mcp_stats` | `None` | `dict` | MCPç»Ÿè®¡ä¿¡æ¯ | âœ… ä½¿ç”¨ä¸­ |

#### æ–‡ä»¶ä¸Šä¼ è½¬æ¢ (file_upload.py)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `upload_and_convert_files` | `files: List[UploadFile], target_folder: str` | `FileUploadResponse` | æ‰¹é‡ä¸Šä¼ è½¬æ¢æ–‡ä»¶ä¸ºMD | âœ… ä½¿ç”¨ä¸­ |
| `upload_with_progress` | `files: List[UploadFile], target_folder: str` | `FileUploadResponse` | å¸¦è¿›åº¦çš„æ–‡ä»¶ä¸Šä¼ è½¬æ¢ | âœ… ä½¿ç”¨ä¸­ |
| `get_supported_formats` | `None` | `SupportedFormatsResponse` | è·å–æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ | âœ… ä½¿ç”¨ä¸­ |

### ğŸ”§ åç«¯æœåŠ¡å±‚å‡½æ•°

#### æ–‡ä»¶æœåŠ¡ (FileService)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `create_file` | `file: FileCreate, fast_mode: bool` | `File` | åˆ›å»ºæ–‡ä»¶å¹¶ä¿å­˜åˆ°ç£ç›˜ | âœ… ä½¿ç”¨ä¸­ |
| `get_file` | `file_id: int` | `Optional[File]` | è·å–æ–‡ä»¶è®°å½• | âœ… ä½¿ç”¨ä¸­ |
| `get_file_by_path` | `file_path: str` | `Optional[File]` | é€šè¿‡è·¯å¾„è·å–æ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |
| `get_files` | `skip: int, limit: int, include_deleted: bool` | `List[File]` | è·å–æ–‡ä»¶åˆ—è¡¨ | âœ… ä½¿ç”¨ä¸­ |
| `update_file` | `file_id: int, file_update: FileUpdate, fast_mode: bool` | `Optional[File]` | æ›´æ–°æ–‡ä»¶å†…å®¹ | âœ… ä½¿ç”¨ä¸­ |
| `_calculate_content_hash` | `content: str` | `str` | è®¡ç®—å†…å®¹å“ˆå¸Œ | âœ… ä½¿ç”¨ä¸­ |
| `_write_file_to_disk` | `file_path: str, content: str` | `bool` | å†™å…¥æ–‡ä»¶åˆ°ç£ç›˜ | âœ… ä½¿ç”¨ä¸­ |
| `_read_file_from_disk` | `file_path: str` | `Optional[str]` | ä»ç£ç›˜è¯»å–æ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |

#### æ ‡ç­¾æœåŠ¡ (TagService)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `create_tag` | `tag: TagCreate` | `Tag` | åˆ›å»ºæ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `get_tag` | `tag_id: int` | `Optional[Tag]` | è·å–æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `get_tag_by_name` | `name: str` | `Optional[Tag]` | é€šè¿‡åç§°è·å–æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `get_all_tags` | `skip: int, limit: int` | `List[Tag]` | è·å–æ‰€æœ‰æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `get_tags_with_usage_stats` | `skip: int, limit: int` | `List[dict]` | è·å–å¸¦ç»Ÿè®¡çš„æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `update_tag` | `tag_id: int, tag_update: TagUpdate` | `Optional[Tag]` | æ›´æ–°æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `delete_tag` | `tag_id: int` | `Optional[Tag]` | åˆ é™¤æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `search_tags` | `query: str` | `List[Tag]` | æœç´¢æ ‡ç­¾ | âš ï¸ æœªä½¿ç”¨ |

#### æ–‡ä»¶æ ‡ç­¾æœåŠ¡ (FileTagService)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `create_file_tag` | `file_tag: FileTagCreate` | `FileTag` | åˆ›å»ºæ–‡ä»¶æ ‡ç­¾å…³è” | âœ… ä½¿ç”¨ä¸­ |
| `get_file_tag` | `file_id: int, tag_id: int` | `Optional[FileTag]` | è·å–æ–‡ä»¶æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `get_file_tags_by_file` | `file_id: int` | `List[FileTag]` | è·å–æ–‡ä»¶çš„æ‰€æœ‰æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `get_file_tags_by_tag` | `tag_id: int` | `List[FileTag]` | è·å–æ ‡ç­¾çš„æ‰€æœ‰æ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |
| `delete_file_tag` | `file_id: int, tag_id: int` | `Optional[FileTag]` | åˆ é™¤æ–‡ä»¶æ ‡ç­¾å…³è” | âœ… ä½¿ç”¨ä¸­ |
| `delete_all_file_tags` | `file_id: int` | `int` | åˆ é™¤æ–‡ä»¶çš„æ‰€æœ‰æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |

#### é“¾æ¥æœåŠ¡ (LinkService)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `create_link` | `link: LinkCreate` | `Link` | åˆ›å»ºé“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `get_link` | `link_id: int` | `Optional[Link]` | è·å–é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `get_links_by_source_file` | `source_file_id: int` | `List[Link]` | è·å–æºæ–‡ä»¶çš„é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `get_links_by_target_file` | `target_file_id: int` | `List[Link]` | è·å–ç›®æ ‡æ–‡ä»¶çš„é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `get_all_links` | `skip: int, limit: int` | `List[Link]` | è·å–æ‰€æœ‰é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `update_link` | `link_id: int, link_update: LinkUpdate` | `Optional[Link]` | æ›´æ–°é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `delete_link` | `link_id: int` | `Optional[Link]` | åˆ é™¤é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |

#### AIæœåŠ¡ (AIService)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `is_available` | `None` | `bool` | æ£€æŸ¥AIæœåŠ¡æ˜¯å¦å¯ç”¨ | âœ… ä½¿ç”¨ä¸­ |
| `create_embeddings` | `file: File, progress_callback=None` | `bool` | åˆ›å»ºæ–‡ä»¶åµŒå…¥ï¼ˆv1.3.2æ”¯æŒè¿›åº¦å›è°ƒï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `semantic_search` | `query: str, limit: int, similarity_threshold: float` | `List[dict]` | è¯­ä¹‰æœç´¢ | âœ… ä½¿ç”¨ä¸­ |
| `suggest_tags` | `title: str, content: str, max_tags: int` | `List[str]` | AIæ ‡ç­¾å»ºè®® | âœ… ä½¿ç”¨ä¸­ |
| `discover_smart_links` | `file_id: int, content: str, title: str` | `List[dict]` | AIé“¾æ¥å‘ç° | âœ… ä½¿ç”¨ä¸­ |
| `chat_with_context` | `question: str, max_context_length: int, search_limit: int` | `dict` | RAGé—®ç­” | âœ… ä½¿ç”¨ä¸­ |
| `streaming_chat_with_context` | `question: str, max_context_length: int, search_limit: int` | `AsyncGenerator` | æµå¼RAGé—®ç­” | âœ… ä½¿ç”¨ä¸­ |
| `generate_summary` | `content: str, max_length: int` | `Optional[str]` | ç”Ÿæˆæ‘˜è¦ | âš ï¸ æœªä½¿ç”¨ |
| `analyze_content` | `content: str` | `dict` | å†…å®¹åˆ†æ | âš ï¸ æœªä½¿ç”¨ |
| `generate_related_questions` | `content: str, num_questions: int` | `List[str]` | ç”Ÿæˆç›¸å…³é—®é¢˜ | âš ï¸ æœªä½¿ç”¨ |

#### æœç´¢æœåŠ¡ (SearchService)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `search` | `query: str, search_type: str, limit: int, similarity_threshold: float` | `dict` | æ··åˆæœç´¢ | âœ… ä½¿ç”¨ä¸­ |
| `_keyword_search` | `query: str, limit: int` | `List[dict]` | å…³é”®è¯æœç´¢ | âœ… ä½¿ç”¨ä¸­ |
| `_semantic_search` | `query: str, limit: int, similarity_threshold: float` | `List[dict]` | è¯­ä¹‰æœç´¢ | âœ… ä½¿ç”¨ä¸­ |
| `_mixed_search` | `query: str, limit: int, similarity_threshold: float` | `List[dict]` | æ··åˆæœç´¢ | âœ… ä½¿ç”¨ä¸­ |
| `get_search_history` | `limit: int` | `List[dict]` | è·å–æœç´¢å†å² | âœ… ä½¿ç”¨ä¸­ |
| `get_popular_queries` | `limit: int` | `List[dict]` | è·å–çƒ­é—¨æŸ¥è¯¢ | âœ… ä½¿ç”¨ä¸­ |

#### MCPæœåŠ¡ (MCPClientService)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `create_server` | `server_data: MCPServerCreate` | `MCPServer` | åˆ›å»ºMCPæœåŠ¡å™¨ | âœ… ä½¿ç”¨ä¸­ |
| `update_server` | `server_id: int, update_data: MCPServerUpdate` | `Optional[MCPServer]` | æ›´æ–°MCPæœåŠ¡å™¨ | âœ… ä½¿ç”¨ä¸­ |
| `get_available_tools` | `None` | `List[MCPTool]` | è·å–å¯ç”¨å·¥å…· | âœ… ä½¿ç”¨ä¸­ |
| `call_tool` | `request: MCPToolCallRequest` | `MCPToolCallResult` | è°ƒç”¨MCPå·¥å…· | âš ï¸ æœªä½¿ç”¨ |
| `connect_server` | `server_id: int` | `bool` | è¿æ¥æœåŠ¡å™¨ | âœ… ä½¿ç”¨ä¸­ |
| `disconnect_server` | `server_id: int` | `bool` | æ–­å¼€æœåŠ¡å™¨ | âœ… ä½¿ç”¨ä¸­ |
| `discover_tools` | `server_id: int` | `List[MCPTool]` | å‘ç°å·¥å…· | âœ… ä½¿ç”¨ä¸­ |
| `get_server_status` | `server_id: int` | `Optional[dict]` | è·å–æœåŠ¡å™¨çŠ¶æ€ | âœ… ä½¿ç”¨ä¸­ |

#### ç´¢å¼•æœåŠ¡ (IndexService)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `get_index_status` | `None` | `dict` | è·å–ç´¢å¼•çŠ¶æ€ | âœ… ä½¿ç”¨ä¸­ |
| `scan_notes_directory` | `None` | `List[dict]` | æ‰«æç¬”è®°ç›®å½• | âœ… ä½¿ç”¨ä¸­ |
| `rebuild_sqlite_index` | `progress_callback: callable` | `dict` | é‡å»ºSQLiteç´¢å¼• | âœ… ä½¿ç”¨ä¸­ |
| `rebuild_vector_index` | `progress_callback: callable` | `dict` | é‡å»ºå‘é‡ç´¢å¼• | âœ… ä½¿ç”¨ä¸­ |
| `rebuild_all_indexes` | `progress_callback: callable` | `dict` | é‡å»ºæ‰€æœ‰ç´¢å¼• | âœ… ä½¿ç”¨ä¸­ |

#### æ™ºèƒ½åˆ†å—æœåŠ¡ (IntelligentHierarchicalSplitter) - v1.3.2æ–°å¢
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `split_document` | `content: str, title: str, file_id: int, progress_callback=None` | `Dict[str, List[Document]]` | æ™ºèƒ½å¤šå±‚æ¬¡æ–‡æ¡£åˆ†å—ï¼ˆv1.3.2æ”¯æŒè¿›åº¦å›è°ƒï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `_create_summary_direct` | `content: str, title: str, file_id: int, progress_callback=None` | `List[Document]` | ç›´æ¥ç”Ÿæˆæ‘˜è¦ï¼ˆv1.3.2æ”¯æŒè¿›åº¦å›è°ƒï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `_create_summary_with_divide_conquer` | `content: str, title: str, file_id: int, progress_callback=None` | `List[Document]` | åˆ†è€Œæ²»ä¹‹ç”Ÿæˆæ‘˜è¦ï¼ˆv1.3.2æ”¯æŒè¿›åº¦å›è°ƒï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `_create_outline_direct` | `content: str, title: str, file_id: int, progress_callback=None` | `List[Document]` | ç›´æ¥æå–å¤§çº²ï¼ˆv1.3.2æ”¯æŒè¿›åº¦å›è°ƒï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `_create_outline_with_divide_conquer` | `content: str, title: str, file_id: int, progress_callback=None` | `List[Document]` | åˆ†è€Œæ²»ä¹‹æå–å¤§çº²ï¼ˆv1.3.2æ”¯æŒè¿›åº¦å›è°ƒï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `_create_intelligent_content_layer` | `content: str, title: str, file_id: int, outline_docs: List[Document], progress_callback=None` | `List[Document]` | æ™ºèƒ½å†…å®¹åˆ†å—ï¼ˆv1.3.2æ”¯æŒè¿›åº¦å›è°ƒï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `_fallback_to_simple_chunking` | `content: str, title: str, file_id: int` | `Dict[str, List[Document]]` | é™çº§åˆ°ç®€å•åˆ†å— | âœ… ä½¿ç”¨ä¸­ |

#### ä»»åŠ¡å¤„ç†æœåŠ¡ (TaskProcessorService)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `create_pending_task` | `file_id: int, task_type: str, priority: int` | `bool` | åˆ›å»ºå¾…å¤„ç†ä»»åŠ¡ | âœ… ä½¿ç”¨ä¸­ |
| `add_task` | `file_id: int, file_path: str, task_type: str, priority: int` | `bool` | æ·»åŠ ä»»åŠ¡åˆ°é˜Ÿåˆ— | âœ… ä½¿ç”¨ä¸­ |
| `get_pending_tasks` | `limit: int` | `List[PendingTask]` | è·å–å¾…å¤„ç†ä»»åŠ¡ | âœ… ä½¿ç”¨ä¸­ |
| `process_task` | `task: PendingTask` | `bool` | å¤„ç†ä»»åŠ¡ | âœ… ä½¿ç”¨ä¸­ |
| `_process_vector_index_task` | `file: File` | `bool` | å¤„ç†å‘é‡ç´¢å¼•ä»»åŠ¡ | âœ… ä½¿ç”¨ä¸­ |
| `_process_file_import_task` | `task: PendingTask` | `bool` | å¤„ç†æ–‡ä»¶å¯¼å…¥ä»»åŠ¡ï¼ˆå…¥åº“+å‘é‡åŒ–åŸå­æ“ä½œï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `_get_pending_tasks_count` | `None` | `int` | è·å–å¾…å¤„ç†ä»»åŠ¡æ•°é‡ï¼ˆv1.3.2æ–°å¢ï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `_log_chunking_progress` | `file_path: str, step: str, message: str` | `None` | è®°å½•åˆ†å—è¿›åº¦ï¼ˆv1.3.2æ–°å¢ï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `_is_process_running` | `pid: int` | `bool` | æ£€æŸ¥è¿›ç¨‹æ˜¯å¦è¿è¡Œï¼ˆv1.3.2æ–°å¢ï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `process_all_pending_tasks` | `None` | `None` | å¤„ç†æ‰€æœ‰å¾…å¤„ç†ä»»åŠ¡ | âœ… ä½¿ç”¨ä¸­ |
| `cleanup_old_tasks` | `days: int` | `None` | æ¸…ç†æ—§ä»»åŠ¡ | âœ… ä½¿ç”¨ä¸­ |
| `clear_duplicate_pending_tasks` | `None` | `int` | æ¸…ç†é‡å¤ä»»åŠ¡ | âœ… ä½¿ç”¨ä¸­ |
| `get_task_statistics` | `None` | `dict` | è·å–ä»»åŠ¡ç»Ÿè®¡ | âœ… ä½¿ç”¨ä¸­ |
| `get_processor_status` | `None` | `dict` | è·å–ä»»åŠ¡å¤„ç†å™¨çŠ¶æ€ï¼ˆv1.3.3æ–°å¢ï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `start_processor` | `force: bool` | `dict` | å¯åŠ¨ä»»åŠ¡å¤„ç†å™¨ï¼ˆv1.3.3æ–°å¢ï¼‰| âœ… ä½¿ç”¨ä¸­ |
| `stop_processor` | `None` | `dict` | åœæ­¢ä»»åŠ¡å¤„ç†å™¨ï¼ˆv1.3.3æ–°å¢ï¼‰| âœ… ä½¿ç”¨ä¸­ |

### ğŸ¨ å‰ç«¯ç»„ä»¶å‡½æ•°

#### ä¸»åº”ç”¨ç»„ä»¶ (App.tsx)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `handleFileSelect` | `filePath: string, fileName: string` | `void` | å¤„ç†æ–‡ä»¶é€‰æ‹© | âœ… ä½¿ç”¨ä¸­ |
| `handleSearchModalOpen` | `None` | `void` | æ‰“å¼€æœç´¢æ¨¡æ€æ¡† | âœ… ä½¿ç”¨ä¸­ |
| `handleChatModalOpen` | `None` | `void` | æ‰“å¼€èŠå¤©æ¨¡æ€æ¡† | âœ… ä½¿ç”¨ä¸­ |
| `toggleSider` | `None` | `void` | åˆ‡æ¢ä¾§è¾¹æ  | âœ… ä½¿ç”¨ä¸­ |
| `handleKeyDown` | `event: KeyboardEvent` | `void` | å¤„ç†é”®ç›˜äº‹ä»¶ | âœ… ä½¿ç”¨ä¸­ |

#### ç¬”è®°ç¼–è¾‘å™¨ (NoteEditor.tsx)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `loadFileContent` | `filePath: string` | `Promise<void>` | åŠ è½½æ–‡ä»¶å†…å®¹ | âœ… ä½¿ç”¨ä¸­ |
| `handleContentChange` | `value: string` | `void` | å¤„ç†å†…å®¹å˜åŒ– | âœ… ä½¿ç”¨ä¸­ |
| `handleTitleChange` | `e: React.ChangeEvent<HTMLInputElement>` | `void` | å¤„ç†æ ‡é¢˜å˜åŒ– | âœ… ä½¿ç”¨ä¸­ |
| `handleSave` | `None` | `Promise<void>` | ä¿å­˜æ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |
| `wikiLinkPlugin` | `md: MarkdownIt` | `void` | Wikié“¾æ¥æ’ä»¶ | âœ… ä½¿ç”¨ä¸­ |
| `renderMarkdown` | `content: string` | `string` | æ¸²æŸ“Markdown | âœ… ä½¿ç”¨ä¸­ |
| `getWordCount` | `None` | `string` | è·å–å­—æ•°ç»Ÿè®¡ | âœ… ä½¿ç”¨ä¸­ |

#### æ–‡ä»¶æ ‘ç»„ä»¶ (FileTree.tsx)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `loadFileTree` | `None` | `Promise<void>` | åŠ è½½æ–‡ä»¶æ ‘ | âœ… ä½¿ç”¨ä¸­ |
| `handleSelect` | `keys: React.Key[], info: any` | `void` | å¤„ç†æ–‡ä»¶é€‰æ‹© | âœ… ä½¿ç”¨ä¸­ |
| `handleCreate` | `None` | `Promise<void>` | åˆ›å»ºæ–‡ä»¶/ç›®å½• | âœ… ä½¿ç”¨ä¸­ |
| `handleRename` | `None` | `Promise<void>` | é‡å‘½åæ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |
| `handleDelete` | `nodePath: string` | `Promise<void>` | åˆ é™¤æ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |
| `handleRebuildIndex` | `None` | `Promise<void>` | é‡å»ºç´¢å¼• | âœ… ä½¿ç”¨ä¸­ |
| `convertToTreeData` | `nodes: FileTreeNode[]` | `DataNode[]` | è½¬æ¢æ ‘æ•°æ® | âœ… ä½¿ç”¨ä¸­ |

#### æ ‡ç­¾ç®¡ç†å™¨ (TagManager.tsx)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `loadTags` | `None` | `Promise<void>` | åŠ è½½æ ‡ç­¾åˆ—è¡¨ | âœ… ä½¿ç”¨ä¸­ |
| `loadFileTags` | `None` | `Promise<void>` | åŠ è½½æ–‡ä»¶æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `handleSaveTag` | `values: any` | `Promise<void>` | ä¿å­˜æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `handleDeleteTag` | `tagId: number` | `Promise<void>` | åˆ é™¤æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `handleAddTagToFile` | `tagId: number` | `Promise<void>` | æ·»åŠ æ ‡ç­¾åˆ°æ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |
| `handleRemoveTagFromFile` | `tagId: number` | `Promise<void>` | ä»æ–‡ä»¶ç§»é™¤æ ‡ç­¾ | âœ… ä½¿ç”¨ä¸­ |
| `handleAISuggestTags` | `None` | `Promise<void>` | AIæ ‡ç­¾å»ºè®® | âœ… ä½¿ç”¨ä¸­ |

#### é“¾æ¥ç®¡ç†å™¨ (LinkManager.tsx)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `loadAllLinks` | `None` | `Promise<void>` | åŠ è½½æ‰€æœ‰é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `loadFileLinks` | `None` | `Promise<void>` | åŠ è½½æ–‡ä»¶é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `handleCreateLink` | `values: any` | `Promise<void>` | åˆ›å»ºé“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `handleUpdateLink` | `values: any` | `Promise<void>` | æ›´æ–°é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `handleDeleteLink` | `linkId: number` | `Promise<void>` | åˆ é™¤é“¾æ¥ | âœ… ä½¿ç”¨ä¸­ |
| `handleSmartDiscovery` | `None` | `Promise<void>` | æ™ºèƒ½é“¾æ¥å‘ç° | âœ… ä½¿ç”¨ä¸­ |
| `applyLinkSuggestion` | `suggestion: SmartLinkSuggestion` | `Promise<void>` | åº”ç”¨é“¾æ¥å»ºè®® | âœ… ä½¿ç”¨ä¸­ |

#### è‡ªåŠ¨å¤„ç†å™¨ (AutoProcessor.tsx)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `loadFiles` | `None` | `Promise<void>` | åŠ è½½æ–‡ä»¶åˆ—è¡¨ | âœ… ä½¿ç”¨ä¸­ |
| `processFile` | `file: FileData` | `Promise<ProcessingResult>` | å¤„ç†å•ä¸ªæ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |
| `handleBatchProcess` | `None` | `Promise<void>` | æ‰¹é‡å¤„ç†æ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |
| `handlePauseResume` | `None` | `void` | æš‚åœ/æ¢å¤å¤„ç† | âœ… ä½¿ç”¨ä¸­ |
| `handleStop` | `None` | `void` | åœæ­¢å¤„ç† | âœ… ä½¿ç”¨ä¸­ |

#### æœç´¢æ¨¡æ€æ¡† (SearchModal.tsx)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `handleSearch` | `query: string` | `Promise<void>` | æ‰§è¡Œæœç´¢ | âœ… ä½¿ç”¨ä¸­ |
| `loadSearchHistory` | `None` | `Promise<void>` | åŠ è½½æœç´¢å†å² | âœ… ä½¿ç”¨ä¸­ |
| `loadPopularQueries` | `None` | `Promise<void>` | åŠ è½½çƒ­é—¨æŸ¥è¯¢ | âœ… ä½¿ç”¨ä¸­ |
| `handleSelectResult` | `result: SearchResult` | `void` | é€‰æ‹©æœç´¢ç»“æœ | âœ… ä½¿ç”¨ä¸­ |

#### èŠå¤©æ¨¡æ€æ¡† (ChatModal.tsx)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `handleSendMessage` | `None` | `Promise<void>` | å‘é€æ¶ˆæ¯ | âœ… ä½¿ç”¨ä¸­ |
| `handleClearChat` | `None` | `void` | æ¸…ç©ºèŠå¤©è®°å½• | âœ… ä½¿ç”¨ä¸­ |
| `handleDocumentClick` | `doc: any` | `void` | ç‚¹å‡»æ–‡æ¡£ | âœ… ä½¿ç”¨ä¸­ |

#### å…³ç³»å›¾è°± (LinkGraph.tsx)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `initializeGraph` | `None` | `void` | åˆå§‹åŒ–å›¾è°± | âœ… ä½¿ç”¨ä¸­ |
| `updateGraphData` | `None` | `void` | æ›´æ–°å›¾è°±æ•°æ® | âœ… ä½¿ç”¨ä¸­ |
| `fitNetwork` | `None` | `void` | é€‚åº”ç½‘ç»œå¸ƒå±€ | âœ… ä½¿ç”¨ä¸­ |
| `zoomIn` | `None` | `void` | æ”¾å¤§å›¾è°± | âœ… ä½¿ç”¨ä¸­ |
| `zoomOut` | `None` | `void` | ç¼©å°å›¾è°± | âœ… ä½¿ç”¨ä¸­ |
| `focusCurrentFile` | `None` | `void` | èšç„¦å½“å‰æ–‡ä»¶ | âœ… ä½¿ç”¨ä¸­ |

#### MCPç®¡ç†å™¨ (MCPManager.tsx)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `loadServers` | `None` | `Promise<void>` | åŠ è½½MCPæœåŠ¡å™¨ | âœ… ä½¿ç”¨ä¸­ |
| `loadTools` | `None` | `Promise<void>` | åŠ è½½MCPå·¥å…· | âœ… ä½¿ç”¨ä¸­ |
| `loadStats` | `None` | `Promise<void>` | åŠ è½½MCPç»Ÿè®¡ | âœ… ä½¿ç”¨ä¸­ |
| `handleCreateServer` | `None` | `void` | åˆ›å»ºæœåŠ¡å™¨ | âœ… ä½¿ç”¨ä¸­ |
| `handleDeleteServer` | `serverId: number` | `Promise<void>` | åˆ é™¤æœåŠ¡å™¨ | âœ… ä½¿ç”¨ä¸­ |
| `handleConnectServer` | `serverId: number` | `Promise<void>` | è¿æ¥æœåŠ¡å™¨ | âœ… ä½¿ç”¨ä¸­ |
| `handleDisconnectServer` | `serverId: number` | `Promise<void>` | æ–­å¼€æœåŠ¡å™¨ | âœ… ä½¿ç”¨ä¸­ |

### ğŸ—„ï¸ æ•°æ®åº“æ“ä½œå‡½æ•°

#### æ•°æ®åº“åˆå§‹åŒ– (init_db.py)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `check_database_health` | `None` | `dict` | æ£€æŸ¥æ•°æ®åº“å¥åº·çŠ¶æ€ | âœ… ä½¿ç”¨ä¸­ |
| `repair_database` | `health_status: dict` | `bool` | ä¿®å¤æ•°æ®åº“ | âœ… ä½¿ç”¨ä¸­ |
| `init_db` | `None` | `None` | åˆå§‹åŒ–æ•°æ®åº“ | âœ… ä½¿ç”¨ä¸­ |
| `clean_existing_data` | `None` | `None` | æ¸…ç†ç°æœ‰æ•°æ® | âœ… ä½¿ç”¨ä¸­ |

#### æ•°æ®åº“ä¼šè¯ (session.py)
| å‡½æ•°åç§° | è¾“å…¥å‚æ•° | è¾“å‡º | è¯´æ˜ | ä½¿ç”¨æƒ…å†µ |
|---------|---------|------|------|----------|
| `get_db` | `None` | `Generator[Session, None, None]` | è·å–æ•°æ®åº“ä¼šè¯ | âœ… ä½¿ç”¨ä¸­ |

### ğŸ“‹ ä¼˜åŒ–å»ºè®®

#### ğŸ”´ å·²åˆ é™¤çš„å†—ä½™å‡½æ•° âœ…
1. **ä»»åŠ¡ç®¡ç†æ¨¡å—** - âœ… å·²åˆ é™¤æ‰€æœ‰tasks.pyä¸­çš„5ä¸ªAPIæ¥å£
2. **éƒ¨åˆ†AIåŠŸèƒ½** - å†…å®¹åˆ†æã€ç›¸å…³é—®é¢˜ç”Ÿæˆç­‰åŠŸèƒ½æœªè¢«ä½¿ç”¨
3. **éƒ¨åˆ†æ ‡ç­¾åŠŸèƒ½** - æ ‡ç­¾æœç´¢åŠŸèƒ½æœªè¢«ä½¿ç”¨
4. **éƒ¨åˆ†MCPåŠŸèƒ½** - å·¥å…·è°ƒç”¨å†å²ç­‰åŠŸèƒ½æœªè¢«ä½¿ç”¨

#### ğŸŸ¡ éœ€è¦è¯„ä¼°çš„å‡½æ•°
1. **æ–‡ä»¶APIé‡å¤** - `update_file_by_path_api` ä¸ `update_file_api` åŠŸèƒ½é‡å¤
2. **æ ‡ç­¾è¯¦æƒ…API** - `read_tag_api` å’Œ `get_tag_usage_count_api` æœªè¢«ä½¿ç”¨
3. **é“¾æ¥è¯¦æƒ…API** - `read_link_api` æœªè¢«ä½¿ç”¨

#### ğŸŸ¢ æ ¸å¿ƒä¸šåŠ¡å‡½æ•°
1. **æ–‡ä»¶ç®¡ç†** - æ–‡ä»¶CRUDæ“ä½œã€æ–‡ä»¶æ ‘ç®¡ç†
2. **æ ‡ç­¾ç³»ç»Ÿ** - æ ‡ç­¾åˆ›å»ºã€æ–‡ä»¶æ ‡ç­¾å…³è”ã€AIæ ‡ç­¾å»ºè®®
3. **é“¾æ¥ç³»ç»Ÿ** - é“¾æ¥åˆ›å»ºã€æ™ºèƒ½é“¾æ¥å‘ç°
4. **æœç´¢åŠŸèƒ½** - æ··åˆæœç´¢ã€æœç´¢å†å²
5. **AIé›†æˆ** - RAGé—®ç­”ã€æ ‡ç­¾å»ºè®®ã€é“¾æ¥å‘ç°
6. **MCPé›†æˆ** - æœåŠ¡å™¨ç®¡ç†ã€å·¥å…·å‘ç°

### ğŸ“Š ç»Ÿè®¡æ‘˜è¦

| æ¨¡å— | æ€»å‡½æ•°æ•° | ä½¿ç”¨ä¸­ | æœªä½¿ç”¨ | å·²åˆ é™¤ |
|------|---------|--------|--------|----------|
| åç«¯API | 72 | 48 | 24 | 5 |
| åç«¯æœåŠ¡ | 104 | 91 | 13 | 0 |
| å‰ç«¯ç»„ä»¶ | 52 | 52 | 0 | 0 |
| æ•°æ®åº“æ“ä½œ | 4 | 4 | 0 | 0 |
| **æ€»è®¡** | **232** | **195** | **37** | **5** |

**ä½¿ç”¨ç‡**: 84.1% (195/232)
**v1.3.2æ›´æ–°**: æ–°å¢æ™ºèƒ½åˆ†å—æœåŠ¡(7ä¸ªæ–¹æ³•) + ä»»åŠ¡å¤„ç†ç›‘æ§(3ä¸ªæ–¹æ³•)ï¼Œä¼˜åŒ–è¿›åº¦å›è°ƒæœºåˆ¶

## å˜é‡è¯´æ˜

### ç¯å¢ƒå˜é‡
- `OPENAI_BASE_URL` - AIæœåŠ¡åŸºç¡€URL
- `OPENAI_API_KEY` - AIæœåŠ¡APIå¯†é’¥
- `EMBEDDING_BASE_URL` - åµŒå…¥æœåŠ¡URL
- `EMBEDDING_API_KEY` - åµŒå…¥æœåŠ¡å¯†é’¥
- `EMBEDDING_MODEL` - åµŒå…¥æ¨¡å‹åç§°
- `SEMANTIC_SEARCH_THRESHOLD` - è¯­ä¹‰æœç´¢ç›¸ä¼¼åº¦é˜ˆå€¼

### é…ç½®å‚æ•°
- `max_tags_per_file` - æ¯ä¸ªæ–‡ä»¶æœ€å¤§æ ‡ç­¾æ•°ï¼ˆé»˜è®¤5ï¼‰
- `link_similarity_threshold` - é“¾æ¥ç›¸ä¼¼åº¦é˜ˆå€¼ï¼ˆé»˜è®¤0.6ï¼‰
- `search_limit` - æœç´¢ç»“æœé™åˆ¶ï¼ˆé»˜è®¤50ï¼‰
- `context_length` - AIé—®ç­”ä¸Šä¸‹æ–‡é•¿åº¦ï¼ˆé»˜è®¤3000ï¼‰

## å¼€å‘å’Œè´¡çŒ®

### å¼€å‘ç¯å¢ƒè®¾ç½®
```bash
# å‰ç«¯å¼€å‘
cd frontend
npm install
npm run dev

# åç«¯å¼€å‘
cd backend
pip install -r requirements.txt
uvicorn app.main:app --reload
```

### ä»£ç è§„èŒƒ
- å‰ç«¯ï¼šESLint + Prettier
- åç«¯ï¼šBlack + isort
- æäº¤ï¼šéµå¾ªConventional Commitsè§„èŒƒ

### æµ‹è¯•
```bash
# åç«¯æµ‹è¯•
cd backend
pytest

# å‰ç«¯æµ‹è¯•
cd frontend
npm test
```

## æ›´æ–°æ—¥å¿—

### v1.3.3 (2025-01-05) - TXTè½¬MDè‡ªåŠ¨æ ‡é¢˜é—®é¢˜ä¿®å¤ ğŸ”§
- âœ… **ä¿®å¤txtè½¬mdè‡ªåŠ¨æ ‡é¢˜é—®é¢˜**ï¼šè§£å†³txtæ–‡ä»¶è½¬æ¢æ—¶è‡ªåŠ¨æ·»åŠ å¤šä½™##ç¬¦å·çš„é—®é¢˜
- âœ… **ç§»é™¤è¿‡äºå®½æ³›çš„æ ‡é¢˜æ£€æµ‹**ï¼šä¸å†è‡ªåŠ¨è¯†åˆ«çŸ­è¡Œä¸ºæ ‡é¢˜ï¼Œä¿æŒåŸå§‹æ–‡æœ¬æ ¼å¼
- âœ… **åŒæ—¶ä¿®å¤txtå’Œdocxè½¬æ¢**ï¼šä¸¤ç§æ ¼å¼éƒ½ä¸å†è¿›è¡Œè‡ªåŠ¨æ ‡é¢˜æ£€æµ‹
- âœ… **ä¿æŒç”¨æˆ·æ§åˆ¶æƒ**ï¼šç”¨æˆ·å¯ä»¥æ‰‹åŠ¨æ·»åŠ Markdownæ ‡è®°ï¼Œè½¬æ¢ç»“æœæ›´å¯é¢„æµ‹
- âœ… **ä¿®å¤Dockeræ„å»ºé—®é¢˜**ï¼šç§»é™¤å¼•èµ·å“ˆå¸Œå†²çªçš„mypyä¾èµ–
- âœ… **å®Œæ•´æµ‹è¯•éªŒè¯**ï¼šç¡®ä¿è½¬æ¢åçš„æ–‡ä»¶ä¸åŸå§‹æ–‡ä»¶å†…å®¹å®Œå…¨ä¸€è‡´

#### ğŸ”§ æŠ€æœ¯ä¿®å¤è¯¦æƒ…

**é—®é¢˜åˆ†æ**ï¼š
åŸæ¥çš„è½¬æ¢é€»è¾‘ä¸­å­˜åœ¨è¿‡äºå®½æ³›çš„æ ‡é¢˜æ£€æµ‹ï¼š
```python
# åŸé—®é¢˜ä»£ç 
if len(line) < 50 and not line.endswith(('ã€‚', '.', 'ï¼', '!', 'ï¼Ÿ', '?')):
    markdown_lines.append(f"## {line}")  # è‡ªåŠ¨æ·»åŠ ##ç¬¦å·
```

**ä¿®å¤æ–¹æ¡ˆ**ï¼š
```python
# ä¿®å¤åçš„ä»£ç 
# ä¸åšè‡ªåŠ¨æ ‡é¢˜è¯†åˆ«ï¼Œä¿æŒåŸå§‹æ–‡æœ¬æ ¼å¼
# ç”¨æˆ·å¯ä»¥æ‰‹åŠ¨æ·»åŠ Markdownæ ‡è®°
markdown_lines.append(line)
```

**å½±å“èŒƒå›´**ï¼š
- `_convert_txt_to_md()` - TXTæ–‡ä»¶è½¬æ¢é€»è¾‘
- `_convert_docx_to_md()` - DOCXæ–‡ä»¶è½¬æ¢é€»è¾‘

**ä¿®å¤æ•ˆæœ**ï¼š
- âœ… è½¬æ¢åçš„æ–‡ä»¶ä¸åŸå§‹æ–‡ä»¶å†…å®¹å®Œå…¨ä¸€è‡´
- âœ… ä¸å†æ·»åŠ ä»»ä½•å¤šä½™çš„##ç¬¦å·
- âœ… ç”¨æˆ·å¯ä»¥æŒ‰éœ€æ‰‹åŠ¨æ·»åŠ Markdownæ ¼å¼
- âœ… æé«˜è½¬æ¢ç»“æœçš„å¯é¢„æµ‹æ€§å’Œä¸€è‡´æ€§

### v1.3.2 (2025-01-05) - ä»»åŠ¡å¤„ç†å™¨ä¿®å¤ä¸æ—¥å¿—å¢å¼º ğŸ› ï¸
- âœ… **ä¿®å¤ä»»åŠ¡å¤„ç†å™¨é”å®šé—®é¢˜**ï¼šè§£å†³Dockeré‡å¯å"ä»»åŠ¡å¤„ç†å™¨å·²è¿è¡Œä½†å®é™…æœªè¿è¡Œ"çš„å‡è¿è¡Œé—®é¢˜
- âœ… **æ”¹è¿›è¿›ç¨‹æ£€æµ‹æœºåˆ¶**ï¼šä½¿ç”¨psutilæ£€æŸ¥è¿›ç¨‹çœŸå®çŠ¶æ€ï¼Œé¿å…æ­»é”æ–‡ä»¶å¯¼è‡´çš„å¤„ç†åœæ»
- âœ… **è¯¦ç»†æ™ºèƒ½åˆ†å—æ—¥å¿—**ï¼šåœ¨æ¯ä¸ªæ™ºèƒ½åˆ†å—æ­¥éª¤ï¼ˆæ‘˜è¦ç”Ÿæˆã€å¤§çº²æå–ã€å†…å®¹åˆ†å—ã€å‘é‡å­˜å‚¨ï¼‰è¾“å‡ºè¯¦ç»†æ—¥å¿—
- âœ… **ä»»åŠ¡é˜Ÿåˆ—çŠ¶æ€ç›‘æ§**ï¼šæ¯å®Œæˆä¸€ä¸ªä»»åŠ¡éƒ½ä¼šæ˜¾ç¤ºå‰©ä½™å¾…å¤„ç†ä»»åŠ¡æ•°é‡ï¼Œä¾¿äºè¿›åº¦è·Ÿè¸ª
- âœ… **è¿›åº¦å›è°ƒæœºåˆ¶**ï¼šä»ä»»åŠ¡å¤„ç†å™¨åˆ°AIæœåŠ¡å†åˆ°æ™ºèƒ½åˆ†å—å™¨ï¼Œå…¨é“¾è·¯æ”¯æŒè¿›åº¦å›è°ƒ
- âœ… **åˆ†è€Œæ²»ä¹‹ç­–ç•¥æ—¥å¿—**ï¼šå¯¹è¶…é•¿æ–‡æ¡£çš„åˆ†å—å¤„ç†è¿‡ç¨‹è¿›è¡Œè¯¦ç»†æ—¥å¿—è®°å½•
- âœ… **æ·»åŠ psutilä¾èµ–**ï¼šç¡®ä¿è¿›ç¨‹çŠ¶æ€æ£€æµ‹åŠŸèƒ½çš„ç¨³å®šè¿è¡Œ
- âœ… **é”™è¯¯é™çº§å¤„ç†**ï¼šæ™ºèƒ½åˆ†å—å¤±è´¥æ—¶çš„é™çº§å¤„ç†è¿‡ç¨‹ä¹Ÿä¼šè¾“å‡ºç›¸åº”æ—¥å¿—

#### ğŸ”§ æŠ€æœ¯æ”¹è¿›è¯¦æƒ…

##### 1. ä»»åŠ¡å¤„ç†å™¨é”å®šæœºåˆ¶ä¿®å¤
**é—®é¢˜**ï¼šDockeré‡å¯åé”æ–‡ä»¶æ®‹ç•™ï¼Œå¯¼è‡´æ–°çš„ä»»åŠ¡å¤„ç†å™¨æ— æ³•å¯åŠ¨ï¼Œå‡ºç°"ä»»åŠ¡å¤„ç†å™¨å·²è¿è¡Œ"ä½†å®é™…æœªè¿è¡Œçš„å‡è¿è¡ŒçŠ¶æ€ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# åŸæ¥åŸºäºæ—¶é—´çš„æ£€æµ‹ï¼ˆä¸å‡†ç¡®ï¼‰
if datetime.now() - lock_time > timedelta(minutes=10):
    # è®¤ä¸ºé”è¿‡æœŸ

# æ”¹ä¸ºåŸºäºPIDçš„çœŸå®è¿›ç¨‹æ£€æµ‹
def _is_process_running(self, pid: int) -> bool:
    try:
        import psutil
        return psutil.pid_exists(pid)  # ç²¾ç¡®æ£€æµ‹è¿›ç¨‹çŠ¶æ€
    except ImportError:
        os.kill(pid, 0)  # é™çº§ç­–ç•¥
        return True
```

**æ ¸å¿ƒé€»è¾‘**ï¼š
- é”æ–‡ä»¶å­˜å‚¨è¿›ç¨‹PIDè€Œéæ—¶é—´æˆ³
- å¯åŠ¨æ—¶æ£€æŸ¥PIDå¯¹åº”çš„è¿›ç¨‹æ˜¯å¦çœŸå®å­˜åœ¨
- å‘ç°æ­»é”æ–‡ä»¶æ—¶è‡ªåŠ¨æ¸…ç†å¹¶ç»§ç»­æ‰§è¡Œ
- æ˜¾ç¤ºå½“å‰è¿›ç¨‹PIDå’Œé”å®šçŠ¶æ€

##### 2. è¯¦ç»†æ™ºèƒ½åˆ†å—æ—¥å¿—ç³»ç»Ÿ
**åŸå­æ“ä½œ**ï¼šä¸ºæ–‡ä»¶å¯¼å…¥ä»»åŠ¡ï¼ˆ`file_import`ï¼‰æ·»åŠ å®Œæ•´çš„è¿›åº¦ç›‘æ§é“¾è·¯

**è¿›åº¦å›è°ƒé“¾è·¯**ï¼š
```python
# 1. ä»»åŠ¡å¤„ç†å™¨å±‚
TaskProcessor._process_file_import_task(task)
    â†“ progress_callback
# 2. AIæœåŠ¡å±‚  
AIService.create_embeddings(file, progress_callback)
    â†“ progress_callback
# 3. æ™ºèƒ½åˆ†å—å±‚
HierarchicalSplitter.split_document(content, title, file_id, progress_callback)
    â†“ å„ä¸ªå­æ–¹æ³•
_create_summary_direct/with_divide_conquer(progress_callback)
_create_outline_direct/with_divide_conquer(progress_callback)
_create_intelligent_content_layer(progress_callback)
```

**å‡½æ•°å˜åŠ¨**ï¼šä¸ºä»¥ä¸‹8ä¸ªæ ¸å¿ƒæ–¹æ³•æ·»åŠ  `progress_callback` å‚æ•°æ”¯æŒ
1. `AIService.create_embeddings(file, progress_callback=None)`
2. `HierarchicalSplitter.split_document(content, title, file_id, progress_callback=None)`
3. `_create_summary_direct(content, title, file_id, progress_callback=None)`
4. `_create_summary_with_divide_conquer(content, title, file_id, progress_callback=None)`
5. `_create_outline_direct(content, title, file_id, progress_callback=None)`
6. `_create_outline_with_divide_conquer(content, title, file_id, progress_callback=None)`
7. `_create_intelligent_content_layer(content, title, file_id, outline_docs, progress_callback=None)`
8. `_create_basic_fallback_chunks(file, progress_callback=None)`

##### 3. ä»»åŠ¡é˜Ÿåˆ—çŠ¶æ€ç›‘æ§
**æ–°å¢æ–¹æ³•**ï¼š
- `_get_pending_tasks_count()` - è·å–å¾…å¤„ç†ä»»åŠ¡æ•°é‡
- `_log_chunking_progress(file_path, step, message)` - è®°å½•åˆ†å—è¿›åº¦

**æ—¥å¿—åˆ†ç±»æ ‡è¯†**ï¼š
- ğŸ“‹ **ä»»åŠ¡å¼€å§‹**ï¼š`å¼€å§‹å¤„ç†æ–‡ä»¶å¯¼å…¥ä»»åŠ¡ (å¾…å¤„ç†ä»»åŠ¡: X)`
- ğŸ“– **æ–‡ä»¶è¯»å–**ï¼š`æ–‡ä»¶å†…å®¹è¯»å–å®Œæˆ (å¤§å°: Xå­—ç¬¦)`
- ğŸ’¾ **æ•°æ®åº“æ“ä½œ**ï¼š`æ•°æ®åº“è®°å½•ä¿å­˜æˆåŠŸ`
- ğŸ¤– **AIå¤„ç†**ï¼š`å¼€å§‹æ™ºèƒ½å¤šå±‚æ¬¡å‘é‡åˆ†å—`
- ğŸ”§ **åˆ†å—æ­¥éª¤**ï¼š`[æ‘˜è¦ç”Ÿæˆ/å¤§çº²æå–/å†…å®¹åˆ†å—] å…·ä½“æ­¥éª¤è¿›åº¦`
- ğŸ‰ **å®Œæˆæ ‡è¯†**ï¼š`æ–‡ä»¶å¤„ç†å®Œå…¨æˆåŠŸ | å‰©ä½™ä»»åŠ¡: X`

##### 4. åˆ†è€Œæ²»ä¹‹ç­–ç•¥å¢å¼º
**è¶…é•¿æ–‡æ¡£å¤„ç†**ï¼š
- æ–‡æ¡£é•¿åº¦è¶…è¿‡ `llm_context_window * 0.8` æ—¶è‡ªåŠ¨å¯ç”¨åˆ†è€Œæ²»ä¹‹ç­–ç•¥
- æ‘˜è¦ç”Ÿæˆï¼šä½¿ç”¨Refineç­–ç•¥è¿­ä»£å¤„ç†å¤šä¸ªæ–‡æ¡£ç‰‡æ®µ
- å¤§çº²æå–ï¼šé€å—å¤„ç†ååˆå¹¶ä¸ºå®Œæ•´å¤§çº²
- æ¯ä¸ªå¤„ç†æ­¥éª¤éƒ½æœ‰è¯¦ç»†çš„è¿›åº¦æ—¥å¿—

**é”™è¯¯é™çº§å¤„ç†**ï¼š
- æ™ºèƒ½åˆ†å—å¤±è´¥æ—¶è‡ªåŠ¨é™çº§åˆ°åŸºæœ¬åˆ†å—ç­–ç•¥
- é™çº§è¿‡ç¨‹ä¹Ÿä¼šè¾“å‡ºç›¸åº”çš„æ—¥å¿—ä¿¡æ¯
- ç¡®ä¿æ¯ä¸ªæ–‡ä»¶éƒ½èƒ½æˆåŠŸå¤„ç†

##### 5. ä¾èµ–ç®¡ç†ä¼˜åŒ–
**æ–°å¢ä¾èµ–**ï¼š
```txt
# è¿›ç¨‹çŠ¶æ€æ£€æµ‹
psutil>=5.9.0
```

**ç§»é™¤ä¾èµ–**ï¼š
```txt
# ç±»å‹æ£€æŸ¥ï¼ˆå¼€å‘ç¯å¢ƒä¸éœ€è¦ï¼‰
- mypy>=1.7.1
```

#### ğŸ¯ éªŒè¯ç»“æœ
**ä¿®å¤æ•ˆæœ**ï¼š
- âœ… ä»»åŠ¡å¤„ç†å™¨çœŸå®çŠ¶æ€æ£€æµ‹ï¼šä¸å†å‡ºç°å‡è¿è¡Œé—®é¢˜
- âœ… è¯¦ç»†æ™ºèƒ½åˆ†å—æ—¥å¿—ï¼šæ¯ä¸ªæ­¥éª¤éƒ½æœ‰æ¸…æ™°çš„è¿›åº¦æ˜¾ç¤º  
- âœ… ä»»åŠ¡é˜Ÿåˆ—ç›‘æ§ï¼šå®æ—¶æ˜¾ç¤ºå‰©ä½™å¾…å¤„ç†ä»»åŠ¡æ•°é‡
- âœ… å…¨é“¾è·¯è¿›åº¦è·Ÿè¸ªï¼šä»æ–‡ä»¶å¯¼å…¥åˆ°æ™ºèƒ½åˆ†å—çš„å®Œæ•´è¿›åº¦ç›‘æ§
- âœ… emojiå›¾æ ‡åˆ†ç±»ï¼šä¸åŒç±»å‹æ—¥å¿—æœ‰æ¸…æ™°çš„è§†è§‰æ ‡è¯†
- âœ… é”™è¯¯é™çº§æ—¥å¿—ï¼šæ™ºèƒ½åˆ†å—å¤±è´¥æ—¶ä¹Ÿæœ‰ç›¸åº”çš„æ—¥å¿—è¾“å‡º

**å®é™…æ—¥å¿—ç¤ºä¾‹**ï¼š
```
INFO:app.services.task_processor_service:ğŸ“‹ å¼€å§‹å¤„ç†æ–‡ä»¶å¯¼å…¥ä»»åŠ¡: åŒ»å­¦/ç”·ç§‘ç—…ååŒ»éªŒæ¡ˆè§£æ.md (å¾…å¤„ç†ä»»åŠ¡: 2)
INFO:app.services.task_processor_service:ğŸ“– æ–‡ä»¶å†…å®¹è¯»å–å®Œæˆ: åŒ»å­¦/ç”·ç§‘ç—…ååŒ»éªŒæ¡ˆè§£æ.md (å¤§å°: 144872å­—ç¬¦)
INFO:app.services.task_processor_service:ğŸ’¾ æ•°æ®åº“è®°å½•ä¿å­˜æˆåŠŸ: åŒ»å­¦/ç”·ç§‘ç—…ååŒ»éªŒæ¡ˆè§£æ.md
INFO:app.services.task_processor_service:ğŸ¤– å¼€å§‹æ™ºèƒ½å¤šå±‚æ¬¡å‘é‡åˆ†å—: åŒ»å­¦/ç”·ç§‘ç—…ååŒ»éªŒæ¡ˆè§£æ.md
INFO:app.services.task_processor_service:ğŸ”§ [æ‘˜è¦ç”Ÿæˆ] ä½¿ç”¨åˆ†è€Œæ²»ä¹‹ç­–ç•¥ç”Ÿæˆæ‘˜è¦ | æ–‡ä»¶: åŒ»å­¦/ç”·ç§‘ç—…ååŒ»éªŒæ¡ˆè§£æ.md | å‰©ä½™ä»»åŠ¡: 1
INFO:app.services.task_processor_service:ğŸ”§ [å¤§çº²æå–] ä½¿ç”¨åˆ†è€Œæ²»ä¹‹ç­–ç•¥æå–å¤§çº² | æ–‡ä»¶: åŒ»å­¦/ç”·ç§‘ç—…ååŒ»éªŒæ¡ˆè§£æ.md | å‰©ä½™ä»»åŠ¡: 1
INFO:app.services.task_processor_service:ğŸ”§ [æ™ºèƒ½åˆ†å—] åŸºäºå¤§çº²è¿›è¡Œæ™ºèƒ½å†…å®¹åˆ†å— | æ–‡ä»¶: åŒ»å­¦/ç”·ç§‘ç—…ååŒ»éªŒæ¡ˆè§£æ.md | å‰©ä½™ä»»åŠ¡: 1
INFO:app.services.task_processor_service:ğŸ”§ [å‘é‡å­˜å‚¨] æ­£åœ¨ä¿å­˜ 16 ä¸ªåˆ†å—åˆ°å‘é‡æ•°æ®åº“ | æ–‡ä»¶: åŒ»å­¦/ç”·ç§‘ç—…ååŒ»éªŒæ¡ˆè§£æ.md | å‰©ä½™ä»»åŠ¡: 1
INFO:app.services.task_processor_service:ğŸ‰ æ–‡ä»¶å¤„ç†å®Œå…¨æˆåŠŸ: åŒ»å­¦/ç”·ç§‘ç—…ååŒ»éªŒæ¡ˆè§£æ.md | å‰©ä½™ä»»åŠ¡: 0
```

#### ğŸ“Š ä»£ç ä¿®æ”¹ç»Ÿè®¡
- **ä¿®æ”¹æ–‡ä»¶æ•°**ï¼š5ä¸ªæ ¸å¿ƒæ–‡ä»¶
- **æ–°å¢/ä¿®æ”¹ä»£ç **ï¼šçº¦200è¡Œä»£ç 
- **å‡½æ•°ç­¾åå˜æ›´**ï¼š8ä¸ªæ–¹æ³•æ·»åŠ progress_callbackå‚æ•°
- **æ–°å¢æ–¹æ³•**ï¼š2ä¸ªç›‘æ§æ–¹æ³•
- **ä¾èµ–å˜æ›´**ï¼š+1ä¸ªæ–°ä¾èµ–ï¼Œ-1ä¸ªå¼€å‘ä¾èµ–

### v1.3.1 (2025-01-05) - æ‰¹é‡æ–‡ä»¶ä¸Šä¼ ä¼˜åŒ–
- âœ… **ä¿®å¤æ•°æ®åº“é”å®šé—®é¢˜**ï¼šè§£å†³æ‰¹é‡æ–‡ä»¶ä¸Šä¼ æ—¶çš„æ•°æ®åº“é”å®šå†²çª
- âœ… **æ–°å¢æ–‡ä»¶å¯¼å…¥ä»»åŠ¡**ï¼šåˆ›å»º`file_import`ä»»åŠ¡ç±»å‹ï¼Œå®ç°"å…¥åº“+å‘é‡åŒ–"åŸå­æ“ä½œ
- âœ… **ä¼˜åŒ–ä»»åŠ¡é˜Ÿåˆ—æœºåˆ¶**ï¼šæ–‡ä»¶è½¬æ¢åä¸å†ç«‹å³å†™æ•°æ®åº“ï¼Œè€Œæ˜¯æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—
- âœ… **é˜²æ­¢å¹¶å‘å†²çª**ï¼šä»»åŠ¡å¤„ç†å™¨ä¸²è¡Œå¤„ç†æ–‡ä»¶å¯¼å…¥ä»»åŠ¡ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§
- âœ… **æ”¹è¿›é”™è¯¯å¤„ç†**ï¼šå®Œå–„æ–‡ä»¶å¯¼å…¥å¤±è´¥çš„å›æ»šæœºåˆ¶
- âœ… **æå‡ç³»ç»Ÿç¨³å®šæ€§**ï¼šè§£å†³å¤§é‡æ–‡ä»¶ä¸Šä¼ æ—¶çš„ç³»ç»Ÿä¸ç¨³å®šé—®é¢˜

### v1.3.0 (2025-01-04) - æ–‡ä»¶æ‹–æ‹½ä¸Šä¼ è½¬æ¢åŠŸèƒ½
- âœ… æ–°å¢æ–‡ä»¶æ‹–æ‹½ä¸Šä¼ è½¬æ¢åŠŸèƒ½
- âœ… æ”¯æŒ TXTã€MDã€DOCXã€PDF æ ¼å¼æ–‡ä»¶
- âœ… æ™ºèƒ½ç¼–ç æ£€æµ‹ï¼ˆæ”¯æŒ UTF-8ã€GBKã€GB2312 ç­‰ï¼‰
- âœ… æ‰¹é‡æ–‡ä»¶å¤„ç†å’Œè¿›åº¦æ˜¾ç¤º
- âœ… é‡åæ–‡ä»¶è‡ªåŠ¨é‡å‘½å
- âœ… è½¬æ¢ç»“æœæ±‡æ€»æ˜¾ç¤º
- âœ… è‡ªåŠ¨æ·»åŠ ç´¢å¼•ä»»åŠ¡
- âœ… ä¿®æ”¹ nginx é…ç½®æ”¯æŒå¤§æ–‡ä»¶ä¸Šä¼ 

### v1.2.0 (2025-01-04) - é“¾æ¥ç®¡ç†ä¿®å¤
- âœ… ä¿®å¤é“¾æ¥åˆ›å»ºAPI 422é”™è¯¯
- âœ… ä¼˜åŒ–é“¾æ¥æ•°æ®æ¨¡å‹ï¼Œæ”¯æŒå¯é€‰å­—æ®µ
- âœ… æ·»åŠ "é“¾æ¥ç®¡ç†"æ ‡ç­¾é¡µåˆ°ä¸»ç•Œé¢
- âœ… å®ç°æ™ºèƒ½é»˜è®¤å€¼ç”Ÿæˆ
- âœ… å®Œå–„é“¾æ¥ç±»å‹æ”¯æŒ

### v1.1.0 (2024-12-XX) - MCPé›†æˆ
- âœ… å®Œæ•´MCPåè®®æ”¯æŒ
- âœ… MCPæœåŠ¡å™¨ç®¡ç†ç•Œé¢
- âœ… å·¥å…·å‘ç°å’Œè°ƒç”¨åŠŸèƒ½

### v1.0.0 (2024-12-XX) - åŸºç¡€ç‰ˆæœ¬
- âœ… æ ¸å¿ƒç¬”è®°ç®¡ç†åŠŸèƒ½
- âœ… AIé—®ç­”å’Œæœç´¢
- âœ… æ ‡ç­¾å’Œé“¾æ¥ç³»ç»Ÿ
- âœ… å®¹å™¨åŒ–éƒ¨ç½²

## è®¸å¯è¯

MIT License

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤Issueæˆ–Pull Requestã€‚